<!DOCTYPE html>
<html>

		<head>
				<title>stupid file host</title>
				<link rel="stylesheet" href="styles.css">
		</head>

	<body>

		<div class="container">
			<div class="content">
				<h2>Register</h2>
				<form>
					<input type="text" placeholder="Username" id="username" required>
					<input type="password" placeholder="Password" id="password" required>
					<input type="text" placeholder="TOTP" id="totp-code-register" required>
					<input type="text" placeholder="Password Register" id="password-register" required>
					<button id="register-button" type="button" onclick="register()">Register</button>
				</form>
			</div>
		</div>

	</body>
</html>

<script>
	const register = async () => {
		await fetch('/register', {
			method: 'POST',
			headers: {
				'username': document.getElementById('username').value,
				'password': document.getElementById('password').value,
				'totpCodeRegister': document.getElementById('totp-code-register').value,
				'passwordRegister': document.getElementById('password-register').value
			},
		}).then(async resp => {
			const data = await resp.json();
			if (!resp.ok) {
				console.log(data);
				alert('An error ocurred, check console log');
				return;
			}
			console.log(data);
			alert(`Register success. Your TOTP Secret is ${data.totp}. This will only be shown once!`);
			window.location = '/';
		}).catch(err => {
			console.log(err);
		})
	}
</script>